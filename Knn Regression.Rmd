---
title: "Introduction Machine Learning"
output: html_notebook
---

Pada R Notebook ini kita akan melakukan permodelan Machine Learning dengan metode K-NN baik itu untuk kasus regresi maupun klasifikasi. Adapun beberapa library yang perlu di Install dan Load sebagai berikut.

```{r}
install.packages("caret")
install.packages("MLmetrics")
```

```{r}
library(MASS)
library(MLmetrics)
library(caret)
```

Pada kasus regrei kali ini kita menggunakan data boston housing dengan rincian variabel sebagai berikut

- CRIM : per capita crime rate by town
- ZN : proportion of residential land zoned for lots over 25,000 sq.ft.
- INDUS : proportion of non-retail business acres per town.
- CHAS : Charles River dummy variable (1 if tract bounds river; 0 otherwise)
- NOX : nitric oxides concentration (parts per 10 million)
- RM : average number of rooms per dwelling
- AGE : proportion of owner-occupied units built prior to 1940
- DIS : weighted distances to five Boston employment centres
- RAD : index of accessibility to radial highways
- TAX : full-value property-tax rate per $10,000
- PTRATIO : pupil-teacher ratio by town
- B : 1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town
- LSTAT : % lower status of the population
- MEDV : Median value of owner-occupied homes in $1000's

#MEDV variabel respon

```{r}
boston <- MASS::Boston
head(boston)
```

Melakukan scalling untuk variabel prediktor yang bukan kategorik
```{r}

x_scaled <- scale(boston[,-c(4,14)])[,]
boston_scaled <- cbind(x_scaled,boston[,c(4,14)])

head(boston_scaled)
```

Membagi 90% data sebagai training dan 10% sebagai testing
```{r}
indexes <- createDataPartition(boston$medv, p = .9, list = F)
train <- boston_scaled[indexes, ] #discale krn satuan sangat berbeda
test <-boston_scaled[-indexes, ]

train_x <- train[, -14]
train_y <- train[,14]

test_x <- test[, -14]
test_y <- test[,14]


```

Melakukan permodelan KNN Regresi dengan k=5,2,3
```{r}
knnmodel <- knnreg(train_x, train_y,k=2)


pred_y <- predict(knnmodel, data.frame(test_x))

mape_test <- MAPE(pred_y,test_y)*100
rmse_test <- caret::RMSE(test_y, pred_y)

cat("MAPE: ", mape_test," RMSE: ", rmse_test)
```


Plot hasil prediksi dengan aktualnya

```{r}
x = 1:length(test_y)
plot(x, test_y, col = "red", type = "l", lwd=2, main = "Boston housing test data prediction")
lines(x, pred_y, col = "blue", lwd=2)
legend("topright",  legend = c("original-medv", "predicted-medv"), 
       fill = c("red", "blue"), col = 2:3,  adj = c(0, 0.6))
grid() 
```

